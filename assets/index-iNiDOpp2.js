(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();function p(e){return e*Math.PI/180}function m(e){return e*180/Math.PI}var f=(e=>(e.ADD="+",e.SUB="-",e.MUL="*",e.DIV="/",e))(f||{});const D={exp:e=>Math.exp(e),log:e=>Math.log10(e),ln:e=>Math.log(e),deg:e=>m(e),rad:e=>p(e),sin:e=>Math.sin(p(e)),cos:e=>Math.cos(p(e)),tan:e=>Math.tan(p(e)),asin:e=>m(Math.asin(e)),acos:e=>m(Math.acos(e)),atan:e=>m(Math.atan(e)),sqrt:e=>Math.sqrt(e)},w=0;var u=(e=>(e[e.Number=0]="Number",e[e.BinaryOperator=1]="BinaryOperator",e[e.OpenParen=2]="OpenParen",e[e.ClosedParen=3]="ClosedParen",e[e.Identifier=4]="Identifier",e[e.Keyword=5]="Keyword",e[e.EOF=6]="EOF",e))(u||{});function h(e="",r){return{value:e,type:r}}function P(e){return/^[*+/^-]$/.test(e)}function E(e){return/^[a-z]$/i.test(e)}function v(e){return/^\d$/.test(e)}function U(e){return/^\s$/.test(e)}function I(e){const r=new Array;let t=0,l=!1;for(;t<e.length;)if(e[t]==="(")l=!0,r.push(h(e[t++],2));else if(e[t]===")")l=!1,r.push(h(e[t++],3));else if(P(e[t]))r.push(h(e[t++],1));else if(v(e[t])){let i="";for(;t<e.length&&(v(e[t])||e[t]==="."&&v(e[t+1]));)i+=e[t],t++;r.push(h(i,0))}else if(E(e[t])){let i="",n=!1;for(;t<e.length&&(E(e[t])||n&&v(e[t]));)n=!0,i+=e[t],t++;D[i]?r.push(h(i,5)):r.push(h(i,4))}else if(U(e[t]))t++;else throw new Error("Unexpected character '"+e[t]+"' near "+e.slice(0,Math.max(0,t)));if(l)throw new Error("Unexpected end of expression: "+e);return r.push(h("EOF",6)),r}let d;function y(e,r,t,l=!1){var a,o,c,O;l&&(d=0,l=!1);let i=w,n,s;switch(e.type){case u.Number:{i=Number.parseFloat(e.value),t.push(`${i}`);break}case u.BinaryOperator:{let b="";n=y(e.left,r,t);const M=((a=e.left)==null?void 0:a.type)===u.BinaryOperator||((o=e.left)==null?void 0:o.type)===u.Keyword;M&&t.push(`#${++d}`),b=`(${M?"#"+d:n} ${e.operator} `,s=y(e.right,r,t);const A=((c=e.right)==null?void 0:c.type)===u.BinaryOperator||((O=e.right)==null?void 0:O.type)===u.Keyword;switch(A&&t.push(`#${++d}`),b+=`${A?"#"+d:s})`,t.push(b),e.operator){case f.ADD:{i=n+s;break}case f.SUB:{i=n-s;break}case f.MUL:{i=n*s;break}case f.DIV:{i=n/s;break}}t.push(`${i}`);break}case u.Keyword:{i=y(e.argument,r,t),t.push(`#${++d}`),t.push(`(${e.name}(#${d}))`),i=D[e.name](i),t.push(`${i}`);break}case u.Identifier:{i=r.variables[e.name]||w,t.push(`${i}`);break}default:throw new Error(`Unknown node type: ${e.type}`)}return i}function S(e=[]){let r=0;function t(){return e[r].type===u.EOF}function l(...a){return a.includes(e[r].type)}function i(){if(!t()&&l(u.OpenParen)){r++;const a=s();return r++,a}else{if(l(u.Number))return e[r++];if(l(u.Identifier,u.Keyword)){const{type:a,value:o}=e[r++];if(a===u.Keyword){r++;const c=s();return r++,{type:a,name:o,argument:c}}return{type:a,name:o}}else throw new Error(`Unexpected token: ${e[r].value}`)}}function n(){let a=i();for(;!t()&&(e[r].value===f.MUL||e[r].value===f.DIV);){const o=e[r].value;r++;const c=i();a={type:u.BinaryOperator,operator:o,left:a,right:c}}return a}function s(){let a=n();for(;!t()&&(e[r].value===f.ADD||e[r].value===f.SUB);){const o=e[r].value;r++;const c=n();a={type:u.BinaryOperator,operator:o,left:a,right:c}}return a}return s()}function L(e,r,t){const l=I(e),i=S(l);return y(i,r,t,!0)}function K(e){var i;if(!e.includes("#1")||e.length<2)return e.filter((n,s)=>n.startsWith("(")||s===e.length-1);const r={};for(const[n,s]of e.entries())s.startsWith("#")&&(r[s]={result:e[n-1],expr:(i=e[n-2])!=null&&i.startsWith("#")?"":e[n-2]});const t=[];function l(n,s){let a=n;n&&(a=n.replaceAll(/#\d/g,o=>{var c;return((c=r[o])==null?void 0:c.result)||""}),s.unshift(a),n=n.replaceAll(/#\d/g,o=>{var c;return((c=r[o])==null?void 0:c.expr)||""}),n.includes("#")||s.unshift(n)),n.includes("#")&&l(n,s)}return l(e.at(-2)||"",t),t.push(e.at(-1)),t.map(n=>n.replaceAll("((","(").replaceAll("))",")"))}function F(e){const r={variables:{}},t=[],l=e.trim().replace(/(\d)([a-z]|\()/gi,(n,s,a)=>s+"*"+a).split(`
`).filter(n=>{if(n=n.trim(),!n||n.startsWith("#"))return!1;const s=n.replaceAll(" ","").match(/^([A-Za-z]\d?)=(.+)$/);return s?(r.variables[s[1]]=L(s[2],r,[]),!1):!0});let i=w;for(const n of l)i=L(n,r,t);return{value:i,scope:r,solution:K(t)}}function N(e=""){let r=e.includes("#")?"":`<div>Solving: ${e}</div>`;try{const t=F(e);t.solution.length>2?(t.solution.forEach(l=>r+=`<div>= ${l}</div>`),r+=`<div><br/>Answer: ${t.value}</div>`):r+=`<div>Answer: ${t.value}</div>`}catch(t){r=`${t}`}return r}const B=document.querySelector("button"),$=document.querySelector("textarea"),g=document.querySelector("main");function q(){const e=$.value;g.innerHTML+=`<div class="right"><div>${e.replace(/\n/g,"<br/>")}</div></div>`;const r=N(e);g.innerHTML+=`<div class="left"><div>${r}</div></div>`,g.scrollTo(0,g.scrollHeight),$.value=""}B.addEventListener("click",()=>{$.value.length&&q()});$.addEventListener("keyup",e=>{e.ctrlKey&&e.key.toLowerCase()==="enter"&&(e.preventDefault(),B.click())});
