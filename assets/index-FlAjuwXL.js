(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))u(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&u(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function u(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();function g(e){return e*Math.PI/180}function v(e){return e*180/Math.PI}var f=(e=>(e.ADD="+",e.SUB="-",e.MUL="*",e.DIV="/",e))(f||{});const B={exp:e=>Math.exp(e),log:e=>Math.log10(e),ln:e=>Math.log(e),deg:e=>v(e),rad:e=>g(e),sin:e=>Math.sin(g(e)),cos:e=>Math.cos(g(e)),tan:e=>Math.tan(g(e)),asin:e=>v(Math.asin(e)),acos:e=>v(Math.acos(e)),atan:e=>v(Math.atan(e)),sqrt:e=>Math.sqrt(e)},M=0,U={fractionDigits:4};var l=(e=>(e[e.Number=0]="Number",e[e.BinaryOperator=1]="BinaryOperator",e[e.OpenParen=2]="OpenParen",e[e.ClosedParen=3]="ClosedParen",e[e.Identifier=4]="Identifier",e[e.Keyword=5]="Keyword",e[e.EOF=6]="EOF",e))(l||{});function h(e="",r){return{value:e,type:r}}function F(e){return/^[*+/^-]$/.test(e)}function D(e){return/^[a-z]$/i.test(e)}function y(e){return/^\d$/.test(e)}function I(e){return/^\s$/.test(e)}function S(e){const r=new Array;let t=0,u=!1;for(;t<e.length;)if(e[t]==="(")u=!0,r.push(h(e[t++],2));else if(e[t]===")")u=!1,r.push(h(e[t++],3));else if(F(e[t]))r.push(h(e[t++],1));else if(y(e[t])){let i="";for(;t<e.length&&(y(e[t])||e[t]==="."&&y(e[t+1]));)i+=e[t],t++;r.push(h(i,0))}else if(D(e[t])){let i="",n=!1;for(;t<e.length&&(D(e[t])||n&&y(e[t]));)n=!0,i+=e[t],t++;B[i]?r.push(h(i,5)):r.push(h(i,4))}else if(I(e[t]))t++;else throw new Error("Unexpected character '"+e[t]+"' near "+e.slice(0,Math.max(0,t)));if(u)throw new Error("Unexpected end of expression: "+e);return r.push(h("EOF",6)),r}let d;function m(e){return Number.parseFloat(e.toFixed(U.fractionDigits))}function b(e,r,t,u=!1){var a,c,o,p;u&&(d=0,u=!1);let i=M,n,s;switch(e.type){case l.Number:{i=Number.parseFloat(e.value),t.push(`${i}`);break}case l.BinaryOperator:{let w="";n=b(e.left,r,t),n=m(n);const E=((a=e.left)==null?void 0:a.type)===l.BinaryOperator||((c=e.left)==null?void 0:c.type)===l.Keyword;E&&t.push(`#${++d}`),w=`(${E?"#"+d:n} ${e.operator} `,s=b(e.right,r,t),s=m(s);const L=((o=e.right)==null?void 0:o.type)===l.BinaryOperator||((p=e.right)==null?void 0:p.type)===l.Keyword;switch(L&&t.push(`#${++d}`),w+=`${L?"#"+d:s})`,t.push(w),e.operator){case f.ADD:{i=n+s;break}case f.SUB:{i=n-s;break}case f.MUL:{i=n*s;break}case f.DIV:{i=n/s;break}}i=m(i),t.push(`${i}`);break}case l.Keyword:{i=b(e.argument,r,t),i=m(i),t.push(`#${++d}`),t.push(`${e.name}(#${d})`),i=B[e.name](i),i=m(i),t.push(`${i}`);break}case l.Identifier:{i=r.variables[e.name]||M,t.push(`${i}`);break}default:throw new Error(`Unknown node type: ${e.type}`)}return i}function K(e=[]){let r=0;function t(){return e[r].type===l.EOF}function u(...a){return a.includes(e[r].type)}function i(){if(!t()&&u(l.OpenParen)){r++;const a=s();return r++,a}else{if(u(l.Number))return e[r++];if(u(l.Identifier,l.Keyword)){const{type:a,value:c}=e[r++];if(a===l.Keyword){r++;const o=s();return r++,{type:a,name:c,argument:o}}return{type:a,name:c}}else throw new Error(`Unexpected token: ${e[r].value}`)}}function n(){let a=i();for(;!t()&&(e[r].value===f.MUL||e[r].value===f.DIV);){const c=e[r].value;r++;const o=i();a={type:l.BinaryOperator,operator:c,left:a,right:o}}return a}function s(){let a=n();for(;!t()&&(e[r].value===f.ADD||e[r].value===f.SUB);){const c=e[r].value;r++;const o=n();a={type:l.BinaryOperator,operator:c,left:a,right:o}}return a}return s()}function A(e,r,t){const u=S(e),i=K(u);return b(i,r,t,!0)}function N(e){var i;if(!e.includes("#1")||e.length<2)return e.filter((n,s)=>n.startsWith("(")||s===e.length-1);const r={};for(const[n,s]of e.entries())s.startsWith("#")&&(r[s]={result:e[n-1],expr:(i=e[n-2])!=null&&i.startsWith("#")?"":e[n-2]});const t=[];function u(n,s){let a=n;n&&(a=n.replaceAll(/#\d/g,c=>{var o;return((o=r[c])==null?void 0:o.result)||""}),n=n.replaceAll(/#\d/g,c=>{var o,p;return((o=r[c])==null?void 0:o.expr)||((p=r[c])==null?void 0:p.result)||""}),a!==n&&s.unshift(a),n.includes("#")||s.unshift(n)),n.includes("#")&&u(n,s)}return u(e.at(-2)||"",t),t.push(e.at(-1)),t.map(n=>n.startsWith("(")?n.slice(1,-1):n)}function q(e){const r={variables:{}},t=[],u=e.trim().replace(/(\d)([a-z]|\()/gi,(n,s,a)=>s+"*"+a).split(`
`).filter(n=>{if(n=n.trim(),!n||n.startsWith("#"))return!1;const s=n.replaceAll(" ","").match(/^([A-Za-z]\d?)=(.+)$/);return s?(r.variables[s[1]]=A(s[2],r,[]),!1):!0});let i=M;for(const n of u)i=A(n,r,t);return{value:i,scope:r,solution:N(t)}}function W(e=""){let r=e.includes("#")?"":`<div>Solving: ${e}</div>`;try{const t=q(e);t.solution.length>2?(t.solution.forEach(u=>r+=`<div>= ${u}</div>`),r+=`<div><br/>Answer: ${t.value}</div>`):r+=`<div>Answer: ${t.value}</div>`}catch(t){r=`${t}`}return r}const P=document.querySelector("button"),O=document.querySelector("textarea"),$=document.querySelector("main");function z(){const e=O.value;$.innerHTML+=`<div class="right"><div>${e.replace(/\n/g,"<br/>")}</div></div>`;const r=W(e);$.innerHTML+=`<div class="left"><div>${r}</div></div>`,$.scrollTo(0,$.scrollHeight),O.value=""}P.addEventListener("click",()=>{O.value.length&&z()});O.addEventListener("keyup",e=>{e.ctrlKey&&e.key.toLowerCase()==="enter"&&(e.preventDefault(),P.click())});
